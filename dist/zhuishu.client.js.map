{"version":3,"sources":["../src/zhuishu.client.js"],"names":["rest","contentType","dataType","processZhuishuResp","data","filter","ok","err","msg","wrapBookInfo","cover","v2_urls","statics","Zhuishu","recommends","params","gender","major","minor","start","limit","catBooks","type","cats","GET","subCats","optionMinor","books","map","book","ranks","rankBooks","rankId","ranking","searchBooks","key","search","bookInfo","bookId","info","newestChapter","bookIds","reduce","all","_id","chapters","mixToc","chaptersBySource","sourceId","content","link","chapter","comments"],"mappings":"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","file":"zhuishu.client.js","sourcesContent":["\n/**\n * 追书神器客户端描述文件\n * \n * 追书API参考：https://github.com/zimplexing/vue-nReader/blob/master/doc/zhuishushenqi.md\n * 感谢@zimplexing的文档\n * @date 2018-03-18\n */\n\nimport Rest from 'react-rest-kit';\nimport { config } from './config';\n\nconst rest = new Rest({\n  contentType: 'application/json',\n  dataType: 'json',\n});\n\nconst processZhuishuResp = (data, filter = (data) => ({ data })) => {\n  if ('undefined' !== typeof data.ok && !data.ok) {\n    // 追书神器返回错误\n    return { err: data.msg };\n  }\n\n  return filter(data);\n};\n\nconst wrapBookInfo = data => {\n  return {\n    ...data,\n    cover: config.v2_urls.statics() + data.cover,\n  };\n};\n\nconst Zhuishu = {\n  async recommends(params = {}) {\n    const { gender, major, minor, start = 0, limit = 20 } = params;\n\n    return this.catBooks({\n      gender,\n      type: 'hot',\n      major,\n      minor,\n      start,\n      limit,\n    });\n  },\n  async cats() {\n    const { data, err } = await rest.GET(config.v2_urls.cats());\n\n    if (err) {\n      return { err };\n    }\n\n    return processZhuishuResp(data);\n  },\n  async subCats() {\n    const { data, err } = await rest.GET(config.v2_urls.subCats());\n\n    if (err) {\n      return { err };\n    }\n\n    return processZhuishuResp(data);\n  },\n  async catBooks(params = {}) {\n    const { gender, type, major, minor, start = 0, limit = 20 } = params;\n    const optionMinor = minor ? { minor } : {};\n    const { data, err } = await rest.GET(config.v2_urls.catBooks(), {\n      gender,\n      type,\n      major,\n      start,\n      limit,\n      minor: minor ? minor : '',\n    });\n\n    if (err) {\n      return { err };\n    }\n\n    return processZhuishuResp(data, data => ({ data: data.books.map(book => wrapBookInfo(book)) }));\n  },\n  async ranks() {\n    const { data, err } = await rest.GET(config.v2_urls.ranks());\n\n    if (err) {\n      return { err };\n    }\n\n    return processZhuishuResp(data);\n  },\n  async rankBooks(params = {}) {\n    const { rankId } = params;\n    const { data, err } = await rest.GET(config.v2_urls.rankBooks(rankId));\n\n    if (err) {\n      return { err };\n    }\n\n    return processZhuishuResp(data, data => ({ data: data.ranking.map(book => wrapBookInfo(book)) }));\n  },\n  async searchBooks(params = {}) {\n    const { key = '' } = params;\n    const { data, err } = await rest.GET(config.v2_urls.search(key));\n\n    if (err) {\n      // 返回错误\n      return { err };\n    }\n\n    return processZhuishuResp(data, data => ({ data: data.books.map(book => wrapBookInfo(book)) }));\n  },\n  async bookInfo(params = {}) {\n    const { bookId } = params;\n    const { data, err } = await rest.GET(config.v2_urls.info(bookId));\n\n    if (err) {\n      // 返回错误\n      return { err };\n    }\n\n    return processZhuishuResp(data, data => ({ data: wrapBookInfo(data) }));\n  },\n  async newestChapter(params = {}) {\n    const { bookIds } = params;\n    const { data, err } = await rest.GET(config.v2_urls.newestChapter(bookIds));\n\n    if (err) {\n      // 返回错误\n      return { err };\n    }\n\n    return processZhuishuResp(data, data => ({\n      data: data.reduce((all, book) => {\n        all[book._id] = book;\n        return all;\n      }, {})\n    }));\n  },\n  async chapters(params = {}) {\n    const { bookId } = params;\n    const { data, err } = await rest.GET(config.v2_urls.chapters(bookId));\n\n    if (err) {\n      // 返回错误\n      return { err };\n    }\n\n    return processZhuishuResp(data, data => ({ data: data.mixToc.chapters }));\n  },\n  async chaptersBySource(params = {}) {\n    const { sourceId } = params;\n    const { data, err } = await rest.GET(config.v2_urls.chaptersBySource(sourceId));\n\n    if (err) {\n      // 返回错误\n      return { err };\n    }\n\n    return processZhuishuResp(data, data => ({ data: data.chapters }));\n  },\n  async content(params = {}) {\n    const { link } = params;\n    const { data, err } = await rest.GET(config.v2_urls.content(link));\n\n    if (err) {\n      // 返回错误\n      return { err };\n    }\n\n    return processZhuishuResp(data, data => ({ data: data.chapter }));\n  },\n  async comments(params = {}) {\n    return { err: '暂时不支持' };\n  },\n};\n\nexport default Zhuishu;\n"]}